import{r as n,j as e,c as G,s as y}from"./auth-BQqFf9p-.js";import{c as N,w as b,j as v,d as w}from"./db-DCl0--BQ.js";function S({dialogRef:l,closeDialog:f}){const[o,r]=n.useState(!1),[u,c]=n.useState(!1),[t,d]=n.useState(""),[s,m]=n.useState(""),[p,i]=n.useState(!1),[h,g]=n.useState(!1),C=()=>{const a="0123456789";let j="";for(let x=0;x<4;x++)j+=a.charAt(Math.floor(Math.random()*a.length));return j};return e.jsx("dialog",{ref:l,className:"online-game-dialog",children:e.jsxs("div",{className:"online-game-dialog-div",children:[e.jsx("h2",{children:"Online Game"}),!o&&!u&&e.jsxs("div",{className:"options",children:[e.jsx("button",{className:"action-button",onClick:()=>{const a=C();console.log(a),d(a),r(!0),c(!1)},children:"Create Game"}),e.jsx("button",{className:"action-button",onClick:()=>{c(!0),r(!1)},children:"Join Game"})]}),o&&!h&&e.jsxs("div",{className:"create-game-section",children:[e.jsxs("label",{htmlFor:"game-code",children:["Game Code: ",t]}),e.jsx("label",{htmlFor:"display-name",children:"Display Name:"}),e.jsx("input",{type:"text",id:"display-name",value:s,onChange:a=>m(a.target.value)}),p?e.jsx("div",{className:"loader"}):e.jsx("button",{className:"action-button",onClick:async()=>{if(s.trim()===""){alert("Please enter a display name.");return}i(!0),await N(t,localStorage.getItem("userId"),s),i(!1),g(!0),b(t)},children:"Create"})]}),o&&h&&e.jsxs("div",{className:"game-created-section",children:[e.jsx("h3",{children:"Game Created!"}),e.jsx("p",{children:"Share this game code with a friend to join:"}),e.jsx("h2",{className:"game-code-display",children:t}),e.jsx("p",{children:"Waiting for another player to join..."})]}),u&&e.jsxs("div",{className:"join-game-section",children:[e.jsx("label",{htmlFor:"join-game-code",children:"Game Code:"}),e.jsx("input",{type:"text",id:"join-game-code",value:t,onChange:a=>d(a.target.value)}),e.jsx("label",{htmlFor:"join-display-name",children:"Display Name:"}),e.jsx("input",{type:"text",id:"join-display-name",value:s,onChange:a=>m(a.target.value)}),e.jsx("button",{className:"action-button",onClick:async()=>{if(t.trim()===""||s.trim()===""){alert("Please enter both game code and display name.");return}i(!0);const a=await v(t,localStorage.getItem("userId"),s);if(i(!1),a=="dne"){alert("Failed to join game. Please check the game code and try again.");return}window.location.href+=`Online/?gameCode=${t}`},children:"Join"})]}),e.jsx("button",{className:"action-button",onClick:()=>{h&&(w(t),g(!1)),r(!1),c(!1),d(""),m(""),f()},children:"Close"})]})})}G.createRoot(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(I,{})}));function I(){const l=n.useRef(null);return n.useEffect(()=>{y()},[]),e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"title",children:"Tic Tac Gamble"}),e.jsxs("div",{className:"actions",children:[e.jsx("button",{onClick:()=>{window.location.href+="Local/"},children:"Local Game"}),e.jsx("button",{onClick:()=>{l.current?.showModal()},children:"Online Game"})]}),e.jsx(S,{dialogRef:l,closeDialog:()=>{l.current?.close()}})]})}
